webpackJsonp([1],{"59sR":function(e,t){},"9M+g":function(e,t){},Jmt5:function(e,t){},M93x:function(e,t,r){"use strict";var a=r("YK0F"),n=r("VU/8"),s=n(null,a.a,null,null,null);t.a=s.exports},N5qF:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container"},[r("h3",[e._v("Timeblock Rules Test")]),e._v(" "),r("div",{staticClass:"card mb-3"},[r("div",{staticClass:"card-body"},[r("h5",{staticClass:"card-title"},[e._v("Day Of Week")]),e._v(" "),r("div",{staticClass:"bar"},[r("div",{staticClass:"bar-grid"},e._l(e.total_weeks,function(e){return r("div")})),e._v(" "),r("transition-group",{staticClass:"bar-content",attrs:{name:"slide",mode:"out-in"}},e._l(e.rules,function(t){return r("div",{key:t.id,staticClass:"bar-rule",style:e.getRuleStyle(t)},[r("div",{staticClass:"bar-rule-inner"},[e._v(e._s(t.value))])])})),e._v(" "),r("transition",{attrs:{name:"slide"}},[e.showPreliminary?r("div",{staticClass:"bar-rule -preliminary",style:e.getRuleStyle(e.form)},[r("div",{staticClass:"bar-rule-inner"})]):e._e()])],1)])]),e._v(" "),r("h3",[e._v("Add New Rule")]),e._v(" "),e.error?r("div",{staticClass:"alert alert-danger mb-3"},[e._v(e._s(e.error))]):e._e(),e._v(" "),r("div",{staticClass:"card mb-3"},[r("div",{staticClass:"card-body"},[r("form",{on:{submit:function(t){t.preventDefault(),e.submit(t)}}},[r("div",{staticClass:"row"},[r("div",{staticClass:"col"},[r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"formStartWeek"}},[e._v("Start Date")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.start_week,expression:"form.start_week"}],staticClass:"form-control",attrs:{type:"number",id:"formStartWeek",min:"0",max:e.total_weeks,readonly:e.loading},domProps:{value:e.form.start_week},on:{input:function(t){t.target.composing||(e.form.start_week=t.target.value)}}}),e._v(" "),r("small",{staticClass:"form-text text-muted"},[e._v("The week of the year only (0 - 50)")])])]),e._v(" "),r("div",{staticClass:"col"},[r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"formEndWeek"}},[e._v("End Date")]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.form.end_week,expression:"form.end_week"}],staticClass:"form-control",attrs:{type:"number",id:"formEndWeek",min:"0",max:e.total_weeks,readonly:e.loading},domProps:{value:e.form.end_week},on:{input:function(t){t.target.composing||(e.form.end_week=t.target.value)}}}),e._v(" "),r("small",{staticClass:"form-text text-muted"},[e._v("Leave zero for unlimited length, the week number (0 - 50)")])])]),e._v(" "),r("div",{staticClass:"w-100"}),e._v(" "),r("div",{staticClass:"col"},[r("div",{staticClass:"form-group"},[r("label",{attrs:{for:"formDay"}},[e._v("Day of week")]),e._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:e.form.value,expression:"form.value"}],staticClass:"form-control",attrs:{id:"formDay",readonly:e.loading},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.form.value=t.target.multiple?r:r[0]}}},[r("option",{attrs:{value:"MON"}},[e._v("MON")]),e._v(" "),r("option",{attrs:{value:"TUE"}},[e._v("TUE")]),e._v(" "),r("option",{attrs:{value:"WED"}},[e._v("WED")]),e._v(" "),r("option",{attrs:{value:"THU"}},[e._v("THU")]),e._v(" "),r("option",{attrs:{value:"FRI"}},[e._v("FRI")])])])])]),e._v(" "),r("div",{staticClass:"text-center"},[r("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:e.loading}},[e._v("Add")]),e._v(" "),r("button",{staticClass:"btn btn-secondary",attrs:{type:"button",disabled:e.loading},on:{click:e.reset}},[e._v("Reset Form")])])])])]),e._v(" "),r("transition-group",{attrs:{tag:"div",name:"slide-rev"}},e._l(e.notes,function(t,a){return r("div",{key:a,staticClass:"alert alert-info mb-1"},[e._v(e._s(t))])}))],1)},n=[],s={render:a,staticRenderFns:n};t.a=s},NHnr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("7+uW"),n=r("M93x"),s=r("YaEn"),i=r("Jmt5"),o=(r.n(i),r("9M+g"));r.n(o);a.a.config.productionTip=!1,new a.a({el:"#app",router:s.a,template:"<App/>",components:{App:n.a}})},NTRc:function(e,t,r){"use strict";var a=r("fZjL"),n=r.n(a),s=r("//Fk"),i=r.n(s),o=r("woOf"),l=r.n(o),u={start_week:0,end_week:void 0,value:"MON"};t.a={data:function(){return{total_weeks:50,rules:[{id:1,start_week:20,end_week:39,value:"FRI"},{id:2,start_week:40,value:"WED"}],autoincrementIndex:0,form:l()({},u),error:void 0,loading:!1,showPreliminary:!0,notes:[]}},methods:{getNextIndex:function(){return 0===this.autoincrementIndex&&(this.autoincrementIndex=this.rules.reduce(function(e,t){return Math.max(e,t.id)},0)),++this.autoincrementIndex},getRuleStyle:function(e){return{left:Math.floor(e.start_week/this.total_weeks*100)+"%",width:Math.floor(((void 0===e.end_week?this.total_weeks-1:e.end_week)-e.start_week+1)/this.total_weeks*100)+"%"}},submit:function(){this.error=void 0;var e=void 0,t=void 0;try{if(e=Math.floor(this.form.start_week),isNaN(e)||e<0||e>this.total_weeks)throw new Error("Start week field is incorrect");if(""!==this.form.end_week&&void 0!==this.form.end_week&&(t=Math.floor(this.form.end_week),isNaN(t)||t<0||t>this.total_weeks))throw new Error("End week field is incorrect");if(void 0!==e&&void 0!==t&&t<e)throw new Error("End week must be greater than the start week");this.processNewRule({start_week:e,end_week:t,value:this.form.value})}catch(e){this.error=e.message}},reset:function(){this.form=l()({},u),this.error=void 0},processNewRule:function(e){var t=this,r=function(e){return function(){return new i.a(function(t,r){return setTimeout(t,e||1e3)})}};i.a.resolve().then(function(){t.loading=!0,t.notes=[]}).then(r()).then(function(){var r=[];return t.rules.forEach(function(e){r.push({type:"up",week:e.start_week,id:e.id,value:e.value}),e.end_week&&r.push({type:"down",week:e.end_week,id:e.id,value:e.value})}),r.push({type:"up",week:e.start_week,new:!0,value:e.value,unlimited:!e.end_week}),e.end_week&&r.push({type:"down",week:e.end_week,new:!0,value:e.value}),r.sort(function(e,t){return e.week-t.week}),r}).then(function(e){for(var r=[],a=[],n=void 0,s=0;s<e.length;s++){var i=e[s];if("up"===i.type)if(i.new){if(n=i,a.length>0){var o=a[a.length-1];o.week<=i.week-1&&r.push({id:o.id,start_week:o.week,value:o.value,end_week:i.week-1})}if(i.unlimited)break}else a.push(i);else if(i.new)r.push({id:t.getNextIndex(),start_week:n.week,end_week:i.week,value:i.value}),a.length>0&&(a[a.length-1].week=i.week+1,a[a.length-1].id=t.getNextIndex()),n=void 0;else if(a.length>0){var l=a.pop();!n&&l.week<=i.week&&r.push({id:l.id,start_week:l.week,value:l.value,end_week:i.week})}}if(n)r.push({id:t.getNextIndex(),start_week:n.week,value:n.value});else if(a.length>0){var u=a.pop();r.push({id:u.id,start_week:u.week,value:u.value})}return r}).then(function(e){console.log("out",e);var r={};e.forEach(function(e){r[e.id]=e});for(var a=0;a<t.rules.length;a++){var s=t.rules[a],i=r[s.id];i?(s.start_week!==i.start_week||s.end_week!==i.end_week||s.value!==i.value?(console.log("Rule #"+s.id+" changed"),s.start_week=i.start_week,s.end_week=i.end_week,s.value=i.value):console.log("Rule #"+s.id+" - no changes"),delete r[s.id]):(console.log("Rule #"+s.id+" removed"),t.rules.splice(a,1),a--)}n()(r).forEach(function(e){console.log("New rule #"+e+" added"),t.rules.push(r[e])}),t.notes.push("1. Up/Down process finished")}).then(r()).then(function(){t.rules.sort(function(e,t){return e.start_week-t.start_week});for(var e=1;e<t.rules.length;e++){var r=t.rules[e-1],a=t.rules[e];r.end_week===a.start_week-1&&r.value===a.value&&(r.end_week=a.end_week,t.rules.splice(e,1),e--)}t.notes.push("2. Merge consistent rules finished")}).then(function(){t.loading=!1})}}}},YK0F:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement;return(e._self._c||t)("router-view")},n=[],s={render:a,staticRenderFns:n};t.a=s},YaEn:function(e,t,r){"use strict";var a=r("7+uW"),n=r("/ocq"),s=r("pW4T");a.a.use(n.a),t.a=new n.a({mode:"history",routes:[{path:"/",name:"RulesTest",component:s.a}]})},pW4T:function(e,t,r){"use strict";function a(e){r("59sR")}var n=r("NTRc"),s=r("N5qF"),i=r("VU/8"),o=a,l=i(n.a,s.a,o,null,null);t.a=l.exports}},["NHnr"]);
//# sourceMappingURL=app.6740a59d49674d9d6561.js.map